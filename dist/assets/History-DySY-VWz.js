import{r as e,g as s,c as t,b as r,s as a,x as i,F as o,d as l,B as d,o as n,t as c}from"./vendor-BIYNY2sw.js";import{a as m,u as g}from"./index-Di4kh4KU.js";const x={class:"p-8"},y={class:"flex justify-between items-center mb-6"},p={key:0,class:"text-center text-gray-400 text-xl py-12"},u={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},v={class:"p-4"},b={class:"flex justify-between items-center mb-2"},k={class:"text-lg font-medium text-gray-800 dark:text-gray-200 line-clamp-2"},f={key:0,class:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded ml-2"},h={key:0,class:"text-sm text-gray-500 dark:text-gray-400 ml-4 whitespace-nowrap flex items-center"},w={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mb-3"},_={class:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-2"},I={class:"flex justify-end gap-2 mt-2"},j=["onClick"],C=["onClick"],N={__name:"History",setup(N){const H=d(),U=m(),q=g(),B=e([]),F=()=>{B.value=window.services.history.getHistories()},J=async()=>{try{await U.confirm("清空历史记录","确定要清空所有观看历史吗？此操作不可恢复。",(()=>{window.services.history.clearHistories(),F()}))}catch(e){q.error((null==e?void 0:e.message)||"清空历史记录失败")}};return s((()=>{F()})),(e,s)=>(n(),t("div",x,[r("div",y,[s[1]||(s[1]=r("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"观看历史",-1)),B.value.length>0?(n(),t("button",{key:0,class:"px-4 py-2 text-sm bg-red-500 text-white rounded-md transition-colors hover:bg-red-600",onClick:J},s[0]||(s[0]=[r("i",{class:"i-ri-delete-bin-3-line"},null,-1),i(" 清空历史 ")]))):a("",!0)]),0===B.value.length?(n(),t("div",p," 暂无观看历史 ")):(n(),t("div",u,[(n(!0),t(o,null,l(B.value,(e=>(n(),t("div",{key:e.vod_id+"-"+e.sourceId,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden group"},[r("div",v,[r("div",b,[r("h3",k,[i(c(e.vod_name)+" ",1),e.platform&&""!==e.platform?(n(),t("span",f,c(e.platform),1)):a("",!0)]),e.sourceName?(n(),t("span",h,[s[2]||(s[2]=r("i",{class:"i-ri-global-line mr-1"},null,-1)),i(" "+c(e.sourceName),1)])):a("",!0)]),e.vod_remarks?(n(),t("p",w,c(e.vod_remarks),1)):a("",!0),r("div",_,[r("span",null,"第 "+c((e.episodeIndex||0)+1)+" 集",1)]),r("div",I,[r("button",{class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:s=>(e=>{H.push({path:`/player/${e.vod_id}`,query:{title:e.vod_name,vod_id:e.vod_id,sourceId:e.sourceId,sourceName:e.sourceName,platform:e.platform,episodeIndex:e.episodeIndex,episodeUrl:e.episodeUrl,from:"history",keyword:e.keyword,episodes:JSON.stringify(e.episodes||[])}})})(e)},s[3]||(s[3]=[r("i",{class:"i-ri-play-circle-line"},null,-1),i(" 继续观看 ")]),8,j),r("button",{class:"px-3 py-1 text-white hover:bg-red-600 transition-colors bg-red-500 rounded-md",onClick:s=>(async(e,s)=>{try{await U.confirm("删除历史记录","确定要删除这条观看历史吗？",(()=>{window.services.history.removeHistory(e,s),F()}))}catch(t){q.error((null==t?void 0:t.message)||"删除历史记录失败")}})(e.vod_id,e.sourceId)},s[4]||(s[4]=[r("i",{class:"i-ri-delete-bin-2-line"},null,-1),i(" 删除 ")]),8,C)])])])))),128))]))]))}};export{N as default};
