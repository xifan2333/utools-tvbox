import{r as e,C as a,g as r,c as l,b as t,s,x as d,f as o,y as i,t as n,G as u,F as c,d as g,o as b,n as x}from"./vendor-BIYNY2sw.js";import{u as m,a as p}from"./index-CH-wxIn0.js";const y={class:"p-8"},v={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6"},f={class:"grid grid-cols-1 gap-4"},k={class:"flex space-x-2"},w={class:"mt-4"},h={class:"flex items-center space-x-2"},C={class:"text-sm text-blue-600 dark:text-blue-400"},U={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},S={class:"md:col-span-2"},V={class:"flex items-center space-x-2"},I={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},j={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-2xl"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D={class:"md:col-span-2"},P={class:"flex items-center space-x-2"},$={class:"mt-6 flex justify-end space-x-3"},F={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6"},_={class:"space-y-4"},z={class:"flex items-center space-x-4"},G={class:"flex items-center space-x-2"},J={class:"font-medium text-gray-800 dark:text-gray-200"},N={key:0,class:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded"},q={key:1,class:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded"},B={class:"text-sm text-gray-500 dark:text-gray-400"},E={class:"flex items-center space-x-2"},H=["onClick"],K=["onClick"],L=["onClick"],M=["onClick"],Q={__name:"Settings",setup(Q){const R=p(),T=m(),W=e([]),X=e(""),Y=e(!1),Z=e(null),ee=e({id:"",name:"",api:"",detail:"",enabled:!0,isOfficial:!1}),ae=a((()=>X.value||"https://jx.xmflv.com/?url=")),re=()=>{W.value=window.services.video.getSources()},le=()=>{X.value=window.services.parseApi.getParseApi()},te=()=>{try{window.services.parseApi.setParseApi(X.value),T.success("保存解析接口成功")}catch(e){T.error((null==e?void 0:e.message)||"保存解析接口失败")}},se=()=>{if(!(ee.value.id&&ee.value.name&&ee.value.api&&ee.value.detail))return void T.error("请填写完整的站点信息");if(W.value.some((e=>e.id===ee.value.id)))return void T.error("站点ID已存在");const e=window.services.video.validateSource(ee.value);if(e.valid)try{window.services.video.addSource({...ee.value,enabled:!0}),ee.value={id:"",name:"",api:"",detail:"",enabled:!0,isOfficial:!1},re()}catch(a){T.error((null==a?void 0:a.message)||"添加站点失败")}else T.error(e.error||"站点信息校验失败")},de=async()=>{try{if(!Z.value.name||!Z.value.api||!Z.value.detail)return void T.error("请填写完整的站点信息");await window.services.video.updateSource(Z.value.id,{name:Z.value.name,api:Z.value.api,detail:Z.value.detail,isOfficial:Z.value.isOfficial}),Y.value=!1,re(),T.success("站点更新成功")}catch(e){T.error(e.message||"更新站点失败")}},oe=async()=>{try{const e=window.utools.showOpenDialog({title:"选择配置文件",filters:[{name:"JSON",extensions:["json"]}],properties:["openFile"]});if(!(null==e?void 0:e.length))return;const a=await window.services.video.importSources(e[0]);200===a.code?(T.success(`导入成功：新增 ${a.added} 个站点，更新 ${a.updated} 个站点${a.parseUpdated?"，已更新解析接口":""}`),re(),le()):T.error(a.msg||"导入失败")}catch(e){T.error(e.message||"导入失败")}},ie=async()=>{try{const e=await window.services.video.exportSources();200===e.code?T.success(`导出成功：共 ${e.count} 个站点`):T.error(e.msg||"导出失败")}catch(e){T.error(e.message||"导出失败")}};return r((()=>{re(),le()})),(e,a)=>(b(),l("div",y,[t("div",{class:"flex justify-between items-center mb-6"},[a[14]||(a[14]=t("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"站点设置",-1)),t("div",{class:"flex space-x-2"},[t("button",{onClick:oe,class:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors flex items-center"},a[12]||(a[12]=[t("i",{class:"i-ri-upload-2-line mr-1"},null,-1),d(" 导入配置 ")])),t("button",{onClick:ie,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center"},a[13]||(a[13]=[t("i",{class:"i-ri-download-2-line mr-1"},null,-1),d(" 导出配置 ")]))])]),t("div",v,[a[17]||(a[17]=t("h2",{class:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-4"},"解析接口配置",-1)),t("div",f,[t("div",null,[a[16]||(a[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"解析接口地址",-1)),t("div",k,[o(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>X.value=e),type:"text",class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入解析接口地址"},null,512),[[i,X.value]]),t("button",{onClick:te,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"}," 保存 ")]),t("div",w,[t("div",h,[a[15]||(a[15]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"当前使用：",-1)),t("span",C,n(ae.value),1)])])])])]),t("div",U,[a[24]||(a[24]=t("h2",{class:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-4"},"添加新站点",-1)),t("div",O,[t("div",null,[a[18]||(a[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"站点名称",-1)),o(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.name=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入站点名称"},null,512),[[i,ee.value.name]])]),t("div",null,[a[19]||(a[19]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"站点ID",-1)),o(t("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>ee.value.id=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入站点ID（英文）"},null,512),[[i,ee.value.id]])]),t("div",null,[a[20]||(a[20]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"API地址",-1)),o(t("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>ee.value.api=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入API地址"},null,512),[[i,ee.value.api]])]),t("div",null,[a[21]||(a[21]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"详情页地址",-1)),o(t("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>ee.value.detail=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入详情页地址"},null,512),[[i,ee.value.detail]])]),t("div",S,[t("label",V,[o(t("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>ee.value.isOfficial=e),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[u,ee.value.isOfficial]]),a[22]||(a[22]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"官采站点",-1))])])]),t("div",{class:"mt-4"},[t("button",{onClick:se,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"},a[23]||(a[23]=[t("i",{class:"i-ri-add-box-line"},null,-1),d(" 添加站点 ")]))])]),Y.value?(b(),l("div",I,[t("div",j,[a[30]||(a[30]=t("h2",{class:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-4"},"编辑站点",-1)),t("div",A,[t("div",null,[a[25]||(a[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"站点名称",-1)),o(t("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>Z.value.name=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入站点名称"},null,512),[[i,Z.value.name]])]),t("div",null,[a[26]||(a[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"站点ID",-1)),o(t("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>Z.value.id=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入站点ID（英文）",disabled:""},null,512),[[i,Z.value.id]])]),t("div",null,[a[27]||(a[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"API地址",-1)),o(t("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>Z.value.api=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入API地址"},null,512),[[i,Z.value.api]])]),t("div",null,[a[28]||(a[28]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"详情页地址",-1)),o(t("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>Z.value.detail=e),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入详情页地址"},null,512),[[i,Z.value.detail]])]),t("div",D,[t("label",P,[o(t("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>Z.value.isOfficial=e),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[u,Z.value.isOfficial]]),a[29]||(a[29]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"官采站点",-1))])])]),t("div",$,[t("button",{onClick:a[11]||(a[11]=e=>Y.value=!1),class:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors"}," 取消 "),t("button",{onClick:de,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"}," 保存 ")])])])):s("",!0),t("div",F,[a[35]||(a[35]=t("h2",{class:"text-lg font-medium text-gray-800 dark:text-gray-200 mb-4"},"站点列表",-1)),t("div",_,[(b(!0),l(c,null,g(W.value,(e=>(b(),l("div",{key:e.id,class:x(["flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",{"border-blue-500 dark:border-blue-500":e.enabled}])},[t("div",z,[t("div",null,[t("div",G,[t("h3",J,n(e.name),1),e.enabled?(b(),l("span",N," 已启用 ")):s("",!0),e.isOfficial?(b(),l("span",q," 官采 ")):s("",!0)]),t("p",B,n(e.api),1)])]),t("div",E,[t("button",{onClick:a=>(e=>{Z.value={...e},Y.value=!0})(e),class:"px-3 py-1 bg-blue-500 text-white rounded-md transition-colors hover:bg-blue-600"},a[31]||(a[31]=[t("i",{class:"i-ri-edit-line"},null,-1),d(" 编辑 ")]),8,H),e.enabled?(b(),l("button",{key:1,onClick:a=>{return r=e.id,window.services.video.disableSource(r),void re();var r},class:"px-3 py-1 bg-yellow-500 text-white rounded-md transition-colors hover:bg-yellow-600"},a[33]||(a[33]=[t("i",{class:"i-ri-close-line"},null,-1),d(" 禁用 ")]),8,L)):(b(),l("button",{key:0,onClick:a=>{return r=e.id,window.services.video.enableSource(r),void re();var r},class:"px-3 py-1 bg-green-500 text-white rounded-md transition-colors hover:bg-green-600"},a[32]||(a[32]=[t("i",{class:"i-ri-check-line"},null,-1),d(" 启用 ")]),8,K)),t("button",{onClick:a=>(async e=>{await R.confirm("删除站点","确定要删除这个站点吗？此操作不可恢复。",(()=>{window.services.video.removeSource(e),re()}))})(e.id),class:"px-3 py-1 bg-red-500 text-white rounded-md transition-colors hover:bg-red-600"},a[34]||(a[34]=[t("i",{class:"i-ri-delete-bin-2-line"},null,-1),d(" 删除 ")]),8,M)])],2)))),128))])])]))}};export{Q as default};
