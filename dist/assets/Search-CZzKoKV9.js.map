{"version":3,"file":"Search-CZzKoKV9.js","sources":["../../src/views/Search.vue"],"sourcesContent":["<template>\n  <div class=\"p-8\">\n    <div class=\"mb-6\">\n      <div class=\"flex items-center space-x-4 mb-4\">\n        <input\n          v-model=\"searchQuery\"\n          type=\"text\"\n          class=\"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200\"\n          placeholder=\"输入关键词搜索\"\n          @keyup.enter=\"search\"\n        >\n        <select\n          v-model=\"selectedSource\"\n          class=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200\"\n        >\n          <option value=\"\">所有站点</option>\n          <option\n            v-for=\"source in sources\"\n            :key=\"source.id\"\n            :value=\"source.id\"\n          >\n            {{ source.name }}\n          </option>\n        </select>\n        <button\n          @click=\"search\"\n          class=\"px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors\"\n        >\n          <i class=\"i-ri-search-line\"></i>\n          搜索\n        </button>\n      </div>\n    </div>\n\n    <div v-if=\"loading\" class=\"text-center py-12\">\n      <div class=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto\"></div>\n      <p class=\"mt-4 text-gray-500 dark:text-gray-400\">搜索中...</p>\n    </div>\n\n    <div v-else-if=\"error\" class=\"text-center py-12 text-red-500\">\n      {{ error }}\n    </div>\n\n    <div v-else-if=\"searchResults.length === 0\" class=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n      暂无搜索结果\n    </div>\n\n    <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n      <div\n        v-for=\"item in searchResults\"\n        :key=\"item.vod_id\"\n        class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden group hover:shadow-lg transition-shadow\"\n      >\n        <div class=\"p-4\">\n          <!-- 标题和来源 -->\n          <div class=\"flex justify-between items-start mb-2\">\n            <h3 class=\"text-lg font-medium text-gray-800 dark:text-gray-200 line-clamp-2\">\n              {{ item.vod_name }}\n            </h3>\n            <span class=\"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded whitespace-nowrap ml-2\">\n              {{ item.sourceName }}\n            </span>\n          </div>\n\n          <!-- 分类和备注 -->\n          <div class=\"flex flex-wrap gap-2 mb-3\">\n            <span class=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded\">\n              {{ item.type_name }}\n            </span>\n            <span v-if=\"item.vod_remarks\" class=\"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded\">\n              {{ item.vod_remarks }}\n            </span>\n          </div>\n\n          <!-- 更新时间 -->\n          <p class=\"text-xs text-gray-500 dark:text-gray-400 mb-3\">\n            更新于 {{ formatDate(item.vod_time) }}\n          </p>\n\n          <!-- 操作按钮 -->\n          <div class=\"flex justify-end\">\n            <button\n              @click=\"playVideo(item)\"\n              class=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors\"\n            >\n              播放\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst router = useRouter()\nconst searchQuery = ref('')\nconst selectedSource = ref('')\nconst searchResults = ref([])\nconst loading = ref(false)\nconst error = ref('')\nconst sources = ref([])\n\n// 加载站点列表\nconst loadSources = () => {\n  sources.value = window.services.video.getSources()\n}\n\n// 搜索视频\nconst search = async () => {\n  if (!searchQuery.value.trim()) {\n    error.value = '请输入搜索关键词'\n    return\n  }\n\n  loading.value = true\n  error.value = ''\n  searchResults.value = []\n\n  try {\n    const result = await window.services.video.search(searchQuery.value, selectedSource.value || null)\n    if (result.code === 200) {\n      searchResults.value = result.list\n    } else {\n      error.value = result.msg\n    }\n  } catch (err) {\n    error.value = '搜索失败，请稍后重试'\n    console.error('搜索失败:', err)\n  } finally {\n    loading.value = false\n  }\n}\n\n// 播放视频\nconst playVideo = (item) => {\n  router.push({\n    path: `/player/${item.vod_id}`,\n    query: {\n      title: item.vod_name,\n      vod_id: item.vod_id,\n      vod_remarks: item.vod_remarks,\n      vod_play_from: item.vod_play_from,\n      type_id: item.type_id,\n      type_name: item.type_name,\n      sourceId: item.sourceId\n    }\n  })\n}\n\n// 格式化日期\nconst formatDate = (dateStr) => {\n  if (!dateStr) return ''\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\nonMounted(() => {\n  loadSources()\n})\n</script> "],"names":["router","useRouter","searchQuery","ref","selectedSource","searchResults","loading","error","sources","loadSources","search","result","err","playVideo","item","formatDate","dateStr","onMounted"],"mappings":"8lCAkGA,MAAMA,EAASC,EAAS,EAClBC,EAAcC,EAAI,EAAE,EACpBC,EAAiBD,EAAI,EAAE,EACvBE,EAAgBF,EAAI,CAAE,CAAA,EACtBG,EAAUH,EAAI,EAAK,EACnBI,EAAQJ,EAAI,EAAE,EACdK,EAAUL,EAAI,CAAE,CAAA,EAGhBM,EAAc,IAAM,CACxBD,EAAQ,MAAQ,OAAO,SAAS,MAAM,WAAU,CAClD,EAGME,EAAS,SAAY,CACzB,GAAI,CAACR,EAAY,MAAM,OAAQ,CAC7BK,EAAM,MAAQ,WACd,MACJ,CAEED,EAAQ,MAAQ,GAChBC,EAAM,MAAQ,GACdF,EAAc,MAAQ,CAAA,EAEtB,GAAI,CACF,MAAMM,EAAS,MAAM,OAAO,SAAS,MAAM,OAAOT,EAAY,MAAOE,EAAe,OAAS,IAAI,EAC7FO,EAAO,OAAS,IAClBN,EAAc,MAAQM,EAAO,KAE7BJ,EAAM,MAAQI,EAAO,GAExB,OAAQC,EAAK,CACZL,EAAM,MAAQ,aACd,QAAQ,MAAM,QAASK,CAAG,CAC9B,QAAY,CACRN,EAAQ,MAAQ,EACpB,CACA,EAGMO,EAAaC,GAAS,CAC1Bd,EAAO,KAAK,CACV,KAAM,WAAWc,EAAK,MAAM,GAC5B,MAAO,CACL,MAAOA,EAAK,SACZ,OAAQA,EAAK,OACb,YAAaA,EAAK,YAClB,cAAeA,EAAK,cACpB,QAASA,EAAK,QACd,UAAWA,EAAK,UAChB,SAAUA,EAAK,QACrB,CACG,CAAA,CACH,EAGMC,EAAcC,GACbA,EACQ,IAAI,KAAKA,CAAO,EACjB,mBAAmB,QAAS,CACtC,KAAM,UACN,MAAO,UACP,IAAK,UACL,KAAM,UACN,OAAQ,SACT,CAAA,EARoB,GAWvB,OAAAC,EAAU,IAAM,CACdR,EAAW,CACb,CAAC"}