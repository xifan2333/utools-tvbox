import{r as e,h as a,g as r,q as t,c as l,b as s,s as d,x as o,e as i,w as n,a as u,f as c,y,z as v,A as g,F as x,d as m,t as p,B as b,o as k}from"./vendor-BIYNY2sw.js";import{u as w}from"./index-DJVIbBCy.js";const f={class:"p-8"},h={class:"mb-6"},_={key:0,class:"bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-800 rounded-md p-4 mb-4"},q={class:"flex"},j={class:"ml-3"},C={class:"mt-2 text-sm text-yellow-700 dark:text-yellow-300"},N={class:"flex items-center space-x-4 mb-4"},S=["value"],z={key:0,class:"text-center py-12"},D={key:1,class:"text-center py-12 text-red-500"},I={key:2,class:"text-center py-12 text-gray-500 dark:text-gray-400"},U={key:3,class:"text-center py-12 text-gray-500 dark:text-gray-400"},V={key:4,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},A={class:"p-4"},B={class:"flex justify-between items-start mb-2"},F={class:"text-lg font-medium text-gray-800 dark:text-gray-200 line-clamp-2"},K={class:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded whitespace-nowrap ml-2"},L={class:"flex flex-wrap gap-2 mb-3"},$={class:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded"},E={key:0,class:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded"},G={class:"text-xs text-gray-500 dark:text-gray-400 mb-3"},H={class:"flex justify-end"},J=["onClick"],M={__name:"Search",setup(M){const O=b(),P=t(),Q=e(""),R=e(""),T=e([]),W=e(!1),X=e(""),Y=e([]),Z=e(!1),ee=w();a((()=>P.query.keyword),(e=>{e&&(Q.value=e,ae())}));const ae=async()=>{if(!Q.value.trim())return X.value="请输入搜索关键词",void ee.error("请输入搜索关键词");W.value=!0,X.value="",T.value=[],Z.value=!0;try{const e=await window.services.video.search(Q.value,R.value||null);T.value=e.list}catch(e){ee.error(e.message||"搜索失败，请稍后重试")}finally{W.value=!1}},re=e=>{if(!e)return"";return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};return r((()=>{(()=>{const e=window.services.video.getSources();Y.value=e||[],0===Y.value.length&&(X.value="请先配置视频源")})(),P.query.keyword&&(Q.value=P.query.keyword,ae())})),(e,a)=>{const r=u("router-link");return k(),l("div",f,[s("div",h,[0===Y.value.length?(k(),l("div",_,[s("div",q,[a[6]||(a[6]=s("div",{class:"flex-shrink-0"},[s("i",{class:"i-ri-information-line text-yellow-400"})],-1)),s("div",j,[a[5]||(a[5]=s("h3",{class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"}," 未配置视频源 ",-1)),s("div",C,[s("p",null,[a[3]||(a[3]=o(" 请前往设置页面添加视频源。点击 ")),i(r,{to:"/settings",class:"font-medium underline text-yellow-800 dark:text-yellow-200 hover:text-yellow-600 dark:hover:text-yellow-400"},{default:n((()=>a[2]||(a[2]=[o(" 这里 ")]))),_:1}),a[4]||(a[4]=o(" 进行配置。 "))])])])])])):d("",!0),s("div",N,[c(s("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>Q.value=e),type:"text",class:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200",placeholder:"输入关键词搜索",onKeyup:v(ae,["enter"])},null,544),[[y,Q.value]]),c(s("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>R.value=e),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-200"},[a[7]||(a[7]=s("option",{value:""},"所有站点",-1)),(k(!0),l(x,null,m(Y.value,(e=>(k(),l("option",{key:e.id,value:e.id},p(e.name),9,S)))),128))],512),[[g,R.value]]),s("button",{onClick:ae,class:"px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"},a[8]||(a[8]=[s("i",{class:"i-ri-search-line"},null,-1),o(" 搜索 ")]))])]),W.value?(k(),l("div",z,a[9]||(a[9]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"},null,-1),s("p",{class:"mt-4 text-gray-500 dark:text-gray-400"},"搜索中...",-1)]))):X.value?(k(),l("div",D,p(X.value),1)):Z.value?0===T.value.length?(k(),l("div",U," 暂无搜索结果 ")):(k(),l("div",V,[(k(!0),l(x,null,m(T.value,(e=>(k(),l("div",{key:e.vod_id,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden group hover:shadow-lg transition-shadow"},[s("div",A,[s("div",B,[s("h3",F,p(e.vod_name),1),s("span",K,p(e.sourceName),1)]),s("div",L,[s("span",$,p(e.type_name),1),e.vod_remarks?(k(),l("span",E,p(e.vod_remarks),1)):d("",!0)]),s("p",G," 更新于 "+p(re(e.vod_time)),1),s("div",H,[s("button",{onClick:a=>(e=>{O.push({path:`/player/${e.vod_id}`,query:{title:e.vod_name,vod_id:e.vod_id,vod_remarks:e.vod_remarks,vod_play_from:e.vod_play_from,type_id:e.type_id,type_name:e.type_name,sourceId:e.sourceId,sourceName:e.sourceName,from:"search"}})})(e),class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors"}," 播放 ",8,J)])])])))),128))])):(k(),l("div",I," 请输入关键词开始搜索 "))])}}};export{M as default};
