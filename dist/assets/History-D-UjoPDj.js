import{r as e,g as t,c as s,b as r,s as a,x as o,F as i,d as l,B as d,o as n,t as c}from"./vendor-BIYNY2sw.js";import{a as m,u as g}from"./index-DXxIOIi3.js";const x={class:"p-8"},p={class:"flex justify-between items-center mb-6"},u={key:0,class:"text-center text-gray-400 text-xl py-12"},y={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},v={class:"p-4"},b={class:"flex justify-between items-center mb-2"},f={class:"text-lg font-medium text-gray-800 dark:text-gray-200 line-clamp-2"},k={key:0,class:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded ml-2"},h={key:0,class:"text-sm text-gray-500 dark:text-gray-400 ml-4 whitespace-nowrap flex items-center"},w={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mb-3"},_={key:1,class:"text-xs text-blue-600 dark:text-blue-300 mb-2"},S={class:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400 mb-2"},I={class:"flex justify-end gap-2 mt-2"},$=["onClick"],j=["onClick"],C={__name:"History",setup(C){const H=d(),N=m(),T=g(),M=e([]),U=()=>{M.value=window.services.history.getHistories()},q=async()=>{try{await N.confirm("清空历史记录","确定要清空所有观看历史吗？此操作不可恢复。",(()=>{window.services.history.clearHistories(),U()}))}catch(e){T.error((null==e?void 0:e.message)||"清空历史记录失败")}},B=e=>{if(!e)return"00:00";const t=Math.floor(e/3600),s=Math.floor(e%3600/60),r=Math.floor(e%60);return t>0?`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`};return t((()=>{U()})),(e,t)=>(n(),s("div",x,[r("div",p,[t[1]||(t[1]=r("h1",{class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},"观看历史",-1)),M.value.length>0?(n(),s("button",{key:0,class:"px-4 py-2 text-sm bg-red-500 text-white rounded-md transition-colors hover:bg-red-600",onClick:q},t[0]||(t[0]=[r("i",{class:"i-ri-delete-bin-3-line"},null,-1),o(" 清空历史 ")]))):a("",!0)]),0===M.value.length?(n(),s("div",u," 暂无观看历史 ")):(n(),s("div",y,[(n(!0),s(i,null,l(M.value,(e=>(n(),s("div",{key:e.vod_id+"-"+e.sourceId,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden group"},[r("div",v,[r("div",b,[r("h3",f,[o(c(e.vod_name)+" ",1),e.platform&&""!==e.platform?(n(),s("span",k,c(e.platform),1)):a("",!0)]),e.sourceName?(n(),s("span",h,[t[2]||(t[2]=r("i",{class:"i-ri-global-line mr-1"},null,-1)),o(" "+c(e.sourceName),1)])):a("",!0)]),e.vod_remarks?(n(),s("p",w,c(e.vod_remarks),1)):a("",!0),e.lastTime>0?(n(),s("div",_,"上次看到 "+c(B(e.lastTime)),1)):a("",!0),r("div",S,[r("span",null,"第 "+c((e.episodeIndex||0)+1)+" 集",1)]),r("div",I,[r("button",{class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:t=>(e=>{H.push({path:`/player/${e.vod_id}`,query:{title:e.vod_name,vod_id:e.vod_id,sourceId:e.sourceId,sourceName:e.sourceName,platform:e.platform,episodeIndex:e.episodeIndex,episodeUrl:e.episodeUrl,lastTime:e.lastTime,from:"history",keyword:e.keyword}})})(e)},t[3]||(t[3]=[r("i",{class:"i-ri-play-circle-line"},null,-1),o(" 继续观看 ")]),8,$),r("button",{class:"px-3 py-1 text-white hover:bg-red-600 transition-colors bg-red-500 rounded-md",onClick:t=>(async(e,t)=>{try{await N.confirm("删除历史记录","确定要删除这条观看历史吗？",(()=>{window.services.history.removeHistory(e,t),U()}))}catch(s){T.error((null==s?void 0:s.message)||"删除历史记录失败")}})(e.vod_id,e.sourceId)},t[4]||(t[4]=[r("i",{class:"i-ri-delete-bin-2-line"},null,-1),o(" 删除 ")]),8,j)])])])))),128))]))]))}};export{C as default};
